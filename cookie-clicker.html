<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cookie Clicker</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background: #0a0a0a;
            background-image: 
                radial-gradient(circle at 20% 50%, rgba(10, 30, 50, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(20, 40, 60, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 40% 20%, rgba(15, 35, 55, 0.2) 0%, transparent 50%),
                linear-gradient(to bottom, #0a1a2e 0%, #16213e 50%, #0f1b2e 100%);
            color: #f0f0f0;
            overflow: hidden;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                repeating-linear-gradient(0deg, rgba(255,255,255,0.03) 0px, transparent 1px, transparent 2px, rgba(255,255,255,0.03) 3px),
                repeating-linear-gradient(90deg, rgba(255,255,255,0.03) 0px, transparent 1px, transparent 2px, rgba(255,255,255,0.03) 3px);
            pointer-events: none;
            z-index: 1;
        }

        #game {
            display: flex;
            height: 100vh;
            position: relative;
            background: transparent;
            z-index: 2;
        }

        /* Textured panels */
        #leftPanel, #rightPanel {
            width: 320px;
            background: linear-gradient(to bottom, rgba(26, 26, 26, 0.95) 0%, rgba(20, 20, 20, 0.95) 100%);
            background-image: 
                repeating-linear-gradient(0deg, rgba(255,255,255,0.02) 0px, transparent 1px, transparent 2px),
                repeating-linear-gradient(90deg, rgba(255,255,255,0.02) 0px, transparent 1px, transparent 2px);
            border: 1px solid rgba(42, 42, 42, 0.8);
            box-shadow: inset 0 0 30px rgba(0,0,0,0.5);
            overflow-y: auto;
            padding: 8px;
        }

        #leftPanel {
            border-right: 1px solid #3a3a3a;
        }

        #rightPanel {
            border-left: 1px solid #3a3a3a;
        }

        #leftPanel::-webkit-scrollbar, #rightPanel::-webkit-scrollbar {
            width: 14px;
        }

        #leftPanel::-webkit-scrollbar-track, #rightPanel::-webkit-scrollbar-track {
            background: #0f0f0f;
        }

        #leftPanel::-webkit-scrollbar-thumb, #rightPanel::-webkit-scrollbar-thumb {
            background: #3a3a3a;
            border-radius: 7px;
            border: 2px solid #0f0f0f;
        }

        #leftPanel::-webkit-scrollbar-thumb:hover, #rightPanel::-webkit-scrollbar-thumb:hover {
            background: #4a4a4a;
        }

        /* Buy amount selector */
        .buy-amount-selector {
            display: flex;
            gap: 4px;
            padding: 8px;
            background: rgba(0,0,0,0.3);
            border-bottom: 2px solid #2a2a2a;
        }

        .buy-amount-btn {
            flex: 1;
            padding: 6px;
            background: linear-gradient(to bottom, #2a2a2a 0%, #222222 100%);
            border: 2px solid #3a3a3a;
            border-radius: 3px;
            color: #ccc;
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.15s;
        }

        .buy-amount-btn:hover {
            background: linear-gradient(to bottom, #3a3a3a 0%, #2f2f2f 100%);
            border-color: #4a4a4a;
        }

        .buy-amount-btn.active {
            background: linear-gradient(to bottom, #264f78 0%, #1e3f5f 100%);
            border-color: #3a6ea5;
            color: #fff;
            box-shadow: 0 0 8px rgba(58, 110, 165, 0.4);
        }

        /* ImGui window header style */
        .section-title {
            background: linear-gradient(to bottom, #2a2a2a 0%, #1f1f1f 100%);
            padding: 6px 8px;
            font-size: 13px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: #aaaaaa;
            border: 1px solid #3a3a3a;
            border-radius: 3px;
            margin-bottom: 8px;
        }

        /* Box button style from uiverse.io */
        .product {
            cursor: pointer;
            border: 3px solid #000;
            background-color: #555;
            padding: 0;
            padding-bottom: 8px;
            transition: 0.1s ease-in-out;
            user-select: none;
            height: auto;
            display: block;
            margin-bottom: 6px;
            border-radius: 0;
            position: relative;
            touch-action: manipulation;
        }

        .product-inner {
            background: linear-gradient(to bottom, #2a2a2a 0%, #222222 100%);
            border: 3px solid #3a3a3a;
            padding: 10px;
            display: flex;
            align-items: center;
            height: 56px;
            position: relative;
        }

        .product:hover .product-inner {
            background: linear-gradient(to bottom, #3a3a3a 0%, #2f2f2f 100%);
            border-color: #4a4a4a;
        }

        .product.pressed {
            padding-bottom: 0 !important;
            margin-bottom: 14px !important;
            transform: translateY(8px) !important;
        }

        .product.enabled {
            background-color: #264f78;
        }

        .product.enabled .product-inner {
            background: linear-gradient(to bottom, #264f78 0%, #1e3f5f 100%);
            border-color: #3a6ea5;
            box-shadow: 0 0 8px rgba(58, 110, 165, 0.4);
        }

        .product.enabled:hover .product-inner {
            background: linear-gradient(to bottom, #2d5a88 0%, #244a6f 100%);
            border-color: #4a7eb5;
        }

        .product.locked {
            opacity: 0.4;
            cursor: not-allowed;
        }

        .product-icon {
            width: 40px;
            height: 40px;
            background: #1a1a1a;
            border: 1px solid #3a3a3a;
            border-radius: 3px;
            margin-right: 8px;
            font-size: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .product-info {
            flex: 1;
            min-width: 0;
        }

        .product-name {
            font-size: 13px;
            font-weight: 500;
            margin-bottom: 2px;
            color: #e0e0e0;
        }

        .product-price {
            font-size: 11px;
            color: #6fa06f;
            font-weight: 400;
        }

        .product.locked .product-price {
            color: #c66;
        }

        .product-count {
            margin-left: auto;
            padding-left: 8px;
            font-size: 20px;
            font-weight: 700;
            color: #8ab4f8;
            text-shadow: 0 0 4px rgba(138, 180, 248, 0.3);
        }

        /* Middle Panel */
        #middlePanel {
            flex: 1;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        #cookieZone {
            position: relative;
            text-align: center;
        }

        #cursorOrbiter {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 0;
            height: 0;
        }

        #bigCookie {
            width: 256px;
            height: 256px;
            cursor: pointer;
            transition: filter 0.05s;
            filter: drop-shadow(0 8px 24px rgba(0,0,0,0.6));
        }

        #bigCookie:hover {
            filter: drop-shadow(0 8px 32px rgba(138,180,248,0.4));
        }

        #bigCookie.cookie-bounce {
            animation: cookieBounce 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        @keyframes cookieBounce {
            0% {
                transform: scale(1);
            }
            30% {
                transform: scale(0.92);
            }
            60% {
                transform: scale(1.08);
            }
            80% {
                transform: scale(0.98);
            }
            100% {
                transform: scale(1);
            }
        }

        #cookieCount {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -280px);
            font-size: 48px;
            font-weight: 700;
            color: #fff;
            text-shadow: 
                0 0 10px rgba(138, 180, 248, 0.5),
                0 4px 8px rgba(0,0,0,0.8),
                0 2px 4px rgba(0,0,0,0.6);
            white-space: nowrap;
            pointer-events: none;
            z-index: 10;
        }

        #cookiePs {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -230px);
            font-size: 18px;
            color: #8ab4f8;
            font-weight: 500;
            text-shadow: 0 2px 4px rgba(0,0,0,0.8);
            white-space: nowrap;
            pointer-events: none;
            z-index: 10;
        }

        #bakeryName {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 28px;
            font-weight: 700;
            color: #fff;
            text-shadow: 
                0 0 20px rgba(138, 180, 248, 0.6),
                0 4px 8px rgba(0,0,0,0.9);
            background: linear-gradient(to bottom, rgba(26, 26, 26, 0.8) 0%, rgba(20, 20, 20, 0.8) 100%);
            padding: 12px 32px;
            border-radius: 8px;
            border: 2px solid rgba(58, 110, 165, 0.5);
            box-shadow: 0 4px 12px rgba(0,0,0,0.5);
            pointer-events: none;
            z-index: 10;
        }

        .particle {
            position: fixed;
            pointer-events: none;
            animation: particleFloat 1s ease-out forwards;
            opacity: 1;
            z-index: 1000;
        }

        .particle img {
            width: 32px;
            height: 32px;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.5));
        }

        @keyframes particleFloat {
            0% {
                transform: translate(0, 0) rotate(0deg) scale(1);
                opacity: 1;
            }
            100% {
                transform: translate(var(--tx), var(--ty)) rotate(var(--rotation)) scale(0);
                opacity: 0;
            }
        }

        .floatingText {
            position: fixed;
            font-size: 24px;
            font-weight: 700;
            color: #fff;
            text-shadow: 0 2px 4px rgba(0,0,0,0.8);
            pointer-events: none;
            animation: floatUp 1s ease-out forwards;
            z-index: 1000;
        }

        @keyframes floatUp {
            0% {
                transform: translateY(0);
                opacity: 1;
            }
            100% {
                transform: translateY(-100px);
                opacity: 0;
            }
        }

        /* ImGui-style tabs */
        .tabs {
            display: flex;
            gap: 4px;
            margin-bottom: 8px;
            background: #1a1a1a;
            padding: 4px;
            border-radius: 3px;
            border: 1px solid #2a2a2a;
        }

        .tab {
            flex: 1;
            padding: 6px 8px;
            background: #222;
            border: 1px solid #2a2a2a;
            border-radius: 2px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 500;
            text-align: center;
            color: #aaa;
            transition: all 0.15s;
        }

        .tab:hover {
            background: #2a2a2a;
            color: #ddd;
        }

        .tab.active {
            background: linear-gradient(to bottom, #264f78 0%, #1e3f5f 100%);
            border-color: #3a6ea5;
            color: #fff;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Box button style for upgrades */
        .upgrade {
            cursor: pointer;
            border: 3px solid #000;
            background-color: #555;
            padding: 0;
            padding-bottom: 6px;
            transition: 0.1s ease-in-out;
            user-select: none;
            width: auto;
            height: auto;
            display: inline-block;
            margin: 4px;
            border-radius: 0;
            touch-action: manipulation;
            -webkit-tap-highlight-color: transparent;
        }

        .upgrade-inner {
            width: 52px;
            height: 52px;
            background: linear-gradient(to bottom, #2a2a2a 0%, #222222 100%);
            border: 3px solid #3a3a3a;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
        }

        .upgrade:hover .upgrade-inner {
            background: linear-gradient(to bottom, #3a3a3a 0%, #2f2f2f 100%);
            border-color: #4a4a4a;
        }

        .upgrade.pressed {
            padding-bottom: 0 !important;
            margin-bottom: 10px !important;
            transform: translateY(6px) !important;
        }

        .upgrade.enabled {
            background-color: #264f78;
        }

        .upgrade.enabled .upgrade-inner {
            background: linear-gradient(to bottom, #264f78 0%, #1e3f5f 100%);
            border-color: #3a6ea5;
            box-shadow: 0 0 8px rgba(58, 110, 165, 0.4);
        }

        .upgrade.enabled:hover .upgrade-inner {
            background: linear-gradient(to bottom, #2d5a88 0%, #244a6f 100%);
        }

        .upgrade.locked {
            opacity: 0.3;
            cursor: not-allowed;
            filter: grayscale(100%);
        }

        .upgrades-container {
            padding: 4px;
            display: flex;
            flex-wrap: wrap;
        }

        /* ImGui-style tooltip */
        .tooltip {
            position: absolute;
            background: rgba(20, 20, 20, 0.98);
            border: 1px solid #4a4a4a;
            padding: 8px 10px;
            border-radius: 4px;
            font-size: 12px;
            pointer-events: none;
            z-index: 1000;
            min-width: 200px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.5);
        }

        .tooltip-title {
            font-weight: 500;
            margin-bottom: 4px;
            color: #8ab4f8;
            font-size: 13px;
        }

        .tooltip-desc {
            margin-bottom: 4px;
            color: #ccc;
            line-height: 1.4;
        }

        .tooltip-price {
            color: #6fa06f;
            font-weight: 500;
        }

        /* Achievement style */
        .achievement {
            background: linear-gradient(to bottom, #2a2a2a 0%, #222222 100%);
            border: 1px solid #3a3a3a;
            padding: 8px;
            margin-bottom: 4px;
            border-radius: 3px;
            display: flex;
            align-items: center;
            opacity: 0.3;
        }

        .achievement.unlocked {
            opacity: 1;
            background: linear-gradient(to bottom, #3a3a2a 0%, #2f2f22 100%);
            border-color: #5a5a3a;
        }

        .achievement-icon {
            width: 40px;
            height: 40px;
            background: #1a1a1a;
            border: 1px solid #3a3a3a;
            border-radius: 3px;
            margin-right: 8px;
            font-size: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .achievement-info {
            flex: 1;
        }

        .achievement-name {
            font-weight: 500;
            font-size: 12px;
            margin-bottom: 2px;
            color: #e0e0e0;
        }

        .achievement-desc {
            font-size: 11px;
            color: #888;
        }

        /* Golden Ladd */
        .golden-cookie {
            position: absolute;
            width: 64px;
            height: 64px;
            cursor: pointer;
            animation: goldenPulse 1s ease-in-out infinite;
            filter: drop-shadow(0 0 12px rgba(255, 215, 0, 0.8)) brightness(1.3) saturate(1.5);
            z-index: 100;
        }

        @keyframes goldenPulse {
            0%, 100% {
                transform: scale(1) rotate(0deg);
            }
            50% {
                transform: scale(1.1) rotate(5deg);
            }
        }

        /* Prestige section */
        .prestige-section {
            padding: 12px;
            background: linear-gradient(to bottom, #2a2a3a 0%, #22222f 100%);
            border: 1px solid #3a3a5a;
            border-radius: 3px;
            margin: 8px 0;
        }

        .prestige-btn {
            width: 100%;
            padding: 10px;
            background: linear-gradient(to bottom, #4a4a6a 0%, #3a3a5a 100%);
            border: 1px solid #5a5a7a;
            border-radius: 3px;
            color: white;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            margin-top: 8px;
            transition: all 0.15s;
        }

        .prestige-btn:hover:not(:disabled) {
            background: linear-gradient(to bottom, #5a5a7a 0%, #4a4a6a 100%);
            border-color: #6a6a8a;
        }

        .prestige-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        /* Stats display */
        .stats-display {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            text-align: center;
            background: rgba(20, 20, 20, 0.9);
            padding: 10px 16px;
            border-radius: 4px;
            border: 1px solid #3a3a3a;
        }

        .stat-line {
            font-size: 11px;
            color: #aaa;
            margin: 2px 0;
        }

        /* Settings buttons */
        .settings-section {
            padding: 4px;
        }

        .settings-btn {
            width: 100%;
            padding: 8px;
            margin: 4px 0;
            background: linear-gradient(to bottom, #2a2a2a 0%, #222222 100%);
            border: 1px solid #3a3a3a;
            border-radius: 3px;
            color: #ddd;
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.15s;
        }

        .settings-btn:hover {
            background: linear-gradient(to bottom, #3a3a3a 0%, #2f2f2f 100%);
            border-color: #4a4a4a;
        }

        .settings-btn.danger {
            background: linear-gradient(to bottom, #5a2a2a 0%, #4a2222 100%);
            border-color: #6a3a3a;
        }

        .settings-btn.danger:hover {
            background: linear-gradient(to bottom, #6a3a3a 0%, #5a2a2a 100%);
        }

        /* Cursor orbiters */
        .cursor-orbiter {
            position: absolute;
            width: 48px;
            height: 48px;
            pointer-events: none;
            animation: orbitCursor 3s linear infinite;
            z-index: 10;
        }

        .cursor-orbiter img {
            width: 100%;
            height: 100%;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.5));
            animation: clickAnimation 0.5s ease-in-out infinite;
        }

        @keyframes orbitCursor {
            from {
                transform: rotate(0deg) translateX(180px) rotate(0deg);
            }
            to {
                transform: rotate(360deg) translateX(180px) rotate(-360deg);
            }
        }

        @keyframes clickAnimation {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(0.9);
            }
        }

        /* Screen shake effect */
        @keyframes shake {
            0%, 100% { transform: translate(0, 0); }
            10%, 30%, 50%, 70%, 90% { transform: translate(-2px, -2px); }
            20%, 40%, 60%, 80% { transform: translate(2px, 2px); }
        }

        .shake {
            animation: shake 0.3s;
        }

        /* Ripple effect on click */
        .ripple {
            position: absolute;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(138,180,248,0.4) 0%, transparent 70%);
            pointer-events: none;
            animation: rippleEffect 0.6s ease-out;
        }

        @keyframes rippleEffect {
            0% {
                width: 0;
                height: 0;
                opacity: 1;
            }
            100% {
                width: 300px;
                height: 300px;
                opacity: 0;
            }
        }

        /* Frenzy/buff timer display */
        .buff-timer {
            position: fixed;
            top: 80px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(20, 20, 20, 0.95);
            padding: 12px 24px;
            border-radius: 8px;
            border: 2px solid;
            font-size: 16px;
            font-weight: 700;
            text-shadow: 0 2px 4px rgba(0,0,0,0.8);
            z-index: 100;
            animation: timerPulse 1s ease-in-out infinite;
        }

        .buff-timer.frenzy {
            border-color: #ff4444;
            color: #ff6666;
            box-shadow: 0 0 20px rgba(255, 68, 68, 0.5);
        }

        .buff-timer.click-frenzy {
            border-color: #ffaa00;
            color: #ffcc44;
            box-shadow: 0 0 20px rgba(255, 170, 0, 0.5);
        }

        @keyframes timerPulse {
            0%, 100% {
                opacity: 1;
                transform: translateX(-50%) scale(1);
            }
            50% {
                opacity: 0.8;
                transform: translateX(-50%) scale(1.05);
            }
        }

        /* Disco Ladd party during frenzy */
        .disco-ladd {
            position: fixed;
            width: 80px;
            height: 80px;
            pointer-events: none;
            z-index: 50;
            animation: discoSpin 2s linear infinite, discoFloat 3s ease-in-out infinite;
            filter: drop-shadow(0 0 10px var(--glow-color));
        }

        @keyframes discoSpin {
            0% {
                transform: rotate(0deg) scale(1);
            }
            25% {
                transform: rotate(90deg) scale(1.2);
            }
            50% {
                transform: rotate(180deg) scale(1);
            }
            75% {
                transform: rotate(270deg) scale(0.8);
            }
            100% {
                transform: rotate(360deg) scale(1);
            }
        }

        @keyframes discoFloat {
            0%, 100% {
                transform: translateY(0) translateX(0);
            }
            25% {
                transform: translateY(-30px) translateX(20px);
            }
            50% {
                transform: translateY(0) translateX(-20px);
            }
            75% {
                transform: translateY(30px) translateX(20px);
            }
        }

        /* Click frenzy glow */
        .click-frenzy-glow {
            animation: clickFrenzyPulse 0.3s ease-in-out infinite;
        }

        @keyframes clickFrenzyPulse {
            0%, 100% {
                filter: drop-shadow(0 0 30px rgba(255,215,0,0.8)) brightness(1.3);
            }
            50% {
                filter: drop-shadow(0 0 50px rgba(255,215,0,1)) brightness(1.6) saturate(2);
            }
        }

        /* Particle burst variations */
        .particle-big {
            animation: particleBigFloat 1.2s ease-out forwards;
        }

        .particle-big img {
            width: 48px !important;
            height: 48px !important;
        }

        @keyframes particleBigFloat {
            0% {
                transform: translate(0, 0) rotate(0deg) scale(1.5);
                opacity: 1;
            }
            100% {
                transform: translate(var(--tx), var(--ty)) rotate(var(--rotation)) scale(0);
                opacity: 0;
            }
        }

        /* Milk bar */
        .milk-bar {
            height: 60px;
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(255, 255, 255, 0.05);
            overflow: hidden;
            pointer-events: none;
            border-top: 1px solid rgba(255,255,255,0.1);
        }

        .milk {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(to bottom, rgba(200,200,255,0.3) 0%, rgba(200,200,255,0.15) 100%);
            transition: height 0.5s;
            height: 0%;
        }

        /* Notification for golden effects */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(20, 20, 20, 0.95);
            border: 1px solid #4a4a4a;
            border-left: 3px solid #8ab4f8;
            padding: 12px 16px;
            border-radius: 4px;
            font-size: 13px;
            font-weight: 500;
            color: #fff;
            box-shadow: 0 4px 12px rgba(0,0,0,0.5);
            animation: slideIn 0.3s ease-out;
            z-index: 2000;
            max-width: 300px;
        }

        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes slideOut {
            from {
                transform: translateX(0);
                opacity: 1;
            }
            to {
                transform: translateX(400px);
                opacity: 0;
            }
        }
    </style>
</head>
<body>
    <div id="game">
        <!-- Left Panel: Buildings -->
        <div id="leftPanel">
            <div class="section-title">Buildings</div>
            
            <div class="buy-amount-selector">
                <div class="buy-amount-btn active" onclick="setBuyAmount(1)">Buy 1</div>
                <div class="buy-amount-btn" onclick="setBuyAmount(10)">Buy 10</div>
                <div class="buy-amount-btn" onclick="setBuyAmount(100)">Buy 100</div>
                <div class="buy-amount-btn" onclick="setBuyAmount('max')">Buy Max</div>
            </div>
            
            <div id="buildingsContainer"></div>
        </div>

        <!-- Middle Panel: Cookie -->
        <div id="middlePanel">
            <div id="bakeryName">Ladd's Bakery</div>
            <div id="cookieCount">0</div>
            <div id="cookiePs">per second: 0</div>
            
            <div id="cookieZone">
                <div id="cursorOrbiter"></div>
                <img src="https://github.com/westval/cookie-clicker-assets/blob/main/image-removebg-preview.png?raw=true" 
                     id="bigCookie" alt="Click me!" draggable="false">
            </div>

            <div class="stats-display">
                <div class="stat-line">Total clicks: <span id="totalClicks">0</span></div>
                <div class="stat-line">Hand-made: <span id="handMade">0</span></div>
                <div class="stat-line">Total earned: <span id="totalEarned">0</span></div>
            </div>

            <div class="milk-bar">
                <div class="milk" id="milkLevel"></div>
            </div>
        </div>

        <!-- Right Panel: Store -->
        <div id="rightPanel">
            <div class="tabs">
                <div class="tab active" onclick="switchTab('upgrades')">Store</div>
                <div class="tab" onclick="switchTab('stats')">Stats</div>
                <div class="tab" onclick="switchTab('achievements')">Achievements</div>
                <div class="tab" onclick="switchTab('prestige')">Prestige</div>
                <div class="tab" onclick="switchTab('options')">Options</div>
            </div>

            <div id="upgrades" class="tab-content active">
                <div class="section-title">Store - Upgrades</div>
                <div class="upgrades-container" id="upgradesContainer"></div>
            </div>

            <div id="stats" class="tab-content">
                <div style="padding: 12px; max-height: 500px; overflow-y: auto;">
                    <div style="font-weight: 700; font-size: 16px; margin-bottom: 16px; color: #8ab4f8;">üìä General</div>
                    
                    <div style="font-size: 12px; line-height: 1.8; color: #ccc; margin-bottom: 20px;">
                        <div>Cookies in bank: <strong style="color: #8ab4f8;"><span id="stats-cookies">0</span></strong></div>
                        <div>Cookies baked (this ascension): <strong style="color: #8ab4f8;"><span id="stats-this-run">0</span></strong></div>
                        <div>Cookies baked (all time): <strong style="color: #8ab4f8;"><span id="stats-all-time">0</span></strong></div>
                        <div>Buildings owned: <strong style="color: #8ab4f8;"><span id="stats-buildings">0</span></strong></div>
                        <div>Cookies per second: <strong style="color: #6fa06f;"><span id="stats-cps">0</span></strong></div>
                        <div>Raw cookies per second: <strong style="color: #6fa06f;"><span id="stats-raw-cps">0</span></strong></div>
                        <div>Cookies per click: <strong style="color: #6fa06f;"><span id="stats-per-click">1</span></strong></div>
                        <div>Cookie clicks: <strong><span id="stats-clicks">0</span></strong></div>
                        <div>Hand-made cookies: <strong><span id="stats-handmade">0</span></strong></div>
                        <div>Golden Ladd clicks: <strong style="color: #d4af37;"><span id="stats-golden">0</span></strong></div>
                    </div>
                    
                    <div style="font-weight: 700; font-size: 16px; margin-bottom: 12px; color: #8ab4f8;">üèÜ Achievements</div>
                    <div style="font-size: 12px; margin-bottom: 16px; color: #ccc;">
                        Achievements unlocked: <strong style="color: #d4af37;"><span id="stats-achievements">0</span>/<span id="stats-achievements-total">0</span></strong>
                    </div>
                    
                    <div id="statsAchievementsContainer" style="display: flex; flex-wrap: wrap; gap: 6px; margin-bottom: 20px;"></div>
                    
                    <div style="font-weight: 700; font-size: 16px; margin-bottom: 12px; color: #8ab4f8;">‚¨ÜÔ∏è Upgrades</div>
                    <div style="font-size: 12px; margin-bottom: 16px; color: #ccc;">
                        Upgrades unlocked: <strong style="color: #8ab4f8;"><span id="stats-upgrades">0</span>/<span id="stats-upgrades-total">0</span></strong>
                    </div>
                </div>
            </div>

            <div id="achievements" class="tab-content">
                <div class="section-title">Achievements</div>
                <div id="achievementsContainer"></div>
            </div>

            <div id="prestige" class="tab-content">
                <div class="prestige-section">
                    <div style="font-weight: 700; font-size: 14px; margin-bottom: 12px; color: #8ab4f8;">üí´ Ascension System</div>
                    
                    <div style="margin-bottom: 12px; font-size: 12px; color: #ccc; line-height: 1.6;">
                        Ascend to gain <strong style="color: #8ab4f8;">Heavenly Chips</strong>, which provide permanent production bonuses across all future runs!
                    </div>
                    
                    <div style="background: rgba(0,0,0,0.3); padding: 8px; border-radius: 3px; margin-bottom: 8px; border: 1px solid #2a2a2a;">
                        <div style="font-size: 11px; margin-bottom: 4px;">Current Prestige Level: <strong style="color: #8ab4f8;"><span id="prestigeLevel">0</span></strong></div>
                        <div style="font-size: 11px; margin-bottom: 4px;">Production Bonus: <strong style="color: #6fa06f;">+<span id="prestigeBonus">0</span>%</strong></div>
                        <div style="font-size: 11px; margin-bottom: 4px;">Total Heavenly Chips: <strong style="color: #d4af37;"><span id="heavenlyChips">0</span></strong></div>
                    </div>
                    
                    <div style="background: rgba(58,110,165,0.2); padding: 8px; border-radius: 3px; margin-bottom: 12px; border: 1px solid #3a6ea5;">
                        <div style="font-size: 11px; font-weight: 500; margin-bottom: 4px; color: #8ab4f8;">On Next Ascension:</div>
                        <div style="font-size: 12px; font-weight: 700;">Gain <span id="gainOnAscension" style="color: #d4af37;">0</span> Heavenly Chips</div>
                        <div style="font-size: 10px; color: #aaa; margin-top: 4px;">
                            Requires: 1 billion total cookies baked
                        </div>
                    </div>
                    
                    <div style="font-size: 11px; color: #888; margin-bottom: 8px; line-height: 1.5;">
                        ‚ö†Ô∏è Ascension will reset all cookies, buildings, and upgrades, but you'll keep achievements and gain permanent bonuses!
                    </div>
                    
                    <button class="prestige-btn" id="prestigeBtn" onclick="doPrestige()">
                        ‚ú® Ascend and Reset
                    </button>
                </div>
            </div>

            <div id="options" class="tab-content">
                <div style="padding: 12px;">
                    <div style="font-weight: 700; font-size: 16px; margin-bottom: 16px; color: #8ab4f8;">‚öôÔ∏è Options</div>
                    
                    <div style="margin-bottom: 20px;">
                        <div style="font-size: 13px; font-weight: 500; margin-bottom: 8px; color: #ccc;">Bakery Name</div>
                        <input type="text" id="bakeryNameInput" value="Ladd's Bakery" maxlength="30" 
                               style="width: 100%; padding: 10px; background: rgba(0,0,0,0.4); border: 2px solid #3a3a3a; 
                                      border-radius: 4px; color: #fff; font-size: 14px; font-family: 'Roboto', sans-serif;"
                               onchange="renameBakery(this.value)">
                    </div>
                    
                    <div style="font-size: 13px; font-weight: 500; margin-bottom: 8px; color: #ccc;">Save Management</div>
                    <button class="settings-btn" onclick="saveGame(); playButtonSound();">üíæ Save Game</button>
                    <button class="settings-btn" onclick="loadGame(); playButtonSound();">üìÇ Load Game</button>
                    <button class="settings-btn" onclick="exportSave(); playButtonSound();">üì§ Export Save</button>
                    <button class="settings-btn" onclick="importSave(); playButtonSound();">üì• Import Save</button>
                    
                    <div style="margin: 20px 0; border-top: 1px solid #3a3a3a; padding-top: 16px;">
                        <button class="settings-btn danger" onclick="if(confirm('Are you sure? This will delete everything!')) { resetGame(); playButtonSound(); }">üóëÔ∏è Wipe Save</button>
                    </div>
                    
                    <div style="margin-top: 24px; padding-top: 20px; border-top: 2px solid #3a3a3a;">
                        <div style="font-size: 13px; font-weight: 500; margin-bottom: 8px; color: #888;">Admin Panel</div>
                        <input type="password" id="adminPassword" placeholder="Enter code to unlock..." 
                               style="width: 100%; padding: 10px; background: rgba(0,0,0,0.4); border: 2px solid #3a3a3a; 
                                      border-radius: 4px; color: #fff; font-size: 13px; font-family: 'Roboto', sans-serif; margin-bottom: 8px;"
                               onchange="checkAdminPassword(this.value)">
                    </div>
                    
                    <div id="adminPanel" style="display: none; margin-top: 16px; padding: 16px; background: rgba(58,110,165,0.15); 
                                                border: 2px solid #3a6ea5; border-radius: 6px;">
                        <div style="font-weight: 700; font-size: 15px; margin-bottom: 16px; color: #8ab4f8;">üîß Admin Controls</div>
                        
                        <div style="margin-bottom: 16px;">
                            <label style="display: block; font-size: 12px; margin-bottom: 6px; color: #ccc;">Add Cookies:</label>
                            <input type="number" id="adminCookies" value="1000000" 
                                   style="width: 100%; padding: 8px; background: rgba(0,0,0,0.4); border: 1px solid #3a3a3a; 
                                          border-radius: 3px; color: #fff; font-size: 13px; margin-bottom: 6px;">
                            <button class="settings-btn" onclick="adminAddCookies(); playButtonSound();" style="font-size: 12px; padding: 8px;">‚ú® Add Cookies</button>
                        </div>
                        
                        <div style="font-size: 12px; margin-bottom: 8px; color: #ccc;">Trigger Events:</div>
                        <button class="settings-btn" onclick="adminTriggerFrenzy(); playButtonSound();" style="font-size: 11px; padding: 7px; margin: 3px;">üî• Frenzy</button>
                        <button class="settings-btn" onclick="adminTriggerClickFrenzy(); playButtonSound();" style="font-size: 11px; padding: 7px; margin: 3px;">üëÜ Click Frenzy</button>
                        <button class="settings-btn" onclick="spawnGoldenCookie(); playButtonSound();" style="font-size: 11px; padding: 7px; margin: 3px;">‚ú® Golden Ladd</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let gameState = {
            cookies: 0,
            totalCookies: 0,
            cookiesPerSecond: 0,
            clickPower: 1,
            totalClicks: 0,
            handMade: 0,
            buildings: {},
            upgrades: {},
            achievements: {},
            prestigeLevel: 0,
            heavenlyChips: 0,
            buildingMultipliers: {},
            globalMultiplier: 1,
            goldenMultiplier: 1,
            goldenMultiplierExpires: 0,
            frenzyMultiplier: 1,
            frenzyExpires: 0,
            goldenClicks: 0,
            bakeryName: "Ladd's Bakery",
            adminUnlocked: false,
            buyAmount: 1
        };

        const goldenEffects = [
            {
                name: 'Frenzy',
                weight: 30,
                effect: () => {
                    gameState.frenzyMultiplier = 7;
                    gameState.frenzyExpires = Date.now() + 77000;
                    showNotification('üî• Frenzy!', 'Production x7 for 77 seconds!');
                    playGoldenSound();
                    startDiscoParty();
                }
            },
            {
                name: 'Lucky',
                weight: 25,
                effect: () => {
                    const bonus = Math.max(gameState.cookies * 0.15, gameState.cookiesPerSecond * 900);
                    gameState.cookies += bonus;
                    gameState.totalCookies += bonus;
                    showNotification('üçÄ Lucky!', `+${formatNumber(bonus)} cookies!`);
                    playGoldenSound();
                }
            },
            {
                name: 'Click Frenzy',
                weight: 15,
                effect: () => {
                    gameState.goldenMultiplier = 777;
                    gameState.goldenMultiplierExpires = Date.now() + 13000;
                    showNotification('üëÜ Click Frenzy!', 'Clicking power x777 for 13 seconds!');
                    playGoldenSound();
                }
            },
            {
                name: 'Cookie Storm',
                weight: 10,
                effect: () => {
                    showNotification('üå™Ô∏è Cookie Storm!', 'Cookies rain from above!');
                    playGoldenSound();
                    for (let i = 0; i < 7; i++) {
                        setTimeout(() => {
                            const bonus = gameState.cookiesPerSecond * 7;
                            gameState.cookies += bonus;
                            gameState.totalCookies += bonus;
                            spawnStormCookie();
                        }, i * 300);
                    }
                }
            },
            {
                name: 'Building Special',
                weight: 15,
                effect: () => {
                    const bonus = gameState.cookiesPerSecond * 60;
                    gameState.cookies += bonus;
                    gameState.totalCookies += bonus;
                    showNotification('üè¢ Building Special!', `+${formatNumber(bonus)} cookies (1 minute of production)!`);
                    playGoldenSound();
                }
            },
            {
                name: 'Blab',
                weight: 5,
                effect: () => {
                    const messages = [
                        'Nathan says: "Keep clicking!"',
                        'Nathan says: "You\'re doing great!"',
                        'Ladd wisdom: "More cookies = more power"',
                        'Nathan mumbles: "Where did I put my socks?"',
                        'Ladd tip: "Buy more Ladd Shacks!"'
                    ];
                    const msg = messages[Math.floor(Math.random() * messages.length)];
                    showNotification('üí¨ Blab', msg);
                    playClickSound();
                }
            }
        ];

        let discoLadds = [];

        function startDiscoParty() {
            // Clear any existing disco ladds
            discoLadds.forEach(ladd => ladd.remove());
            discoLadds = [];
            
            // Create 8 disco dancing Ladds
            const colors = ['#ff0000', '#00ff00', '#0000ff', '#ffff00', '#ff00ff', '#00ffff', '#ff8800', '#ff0088'];
            for (let i = 0; i < 8; i++) {
                const ladd = document.createElement('img');
                ladd.src = 'https://github.com/westval/cookie-clicker-assets/blob/main/image-removebg-preview.png?raw=true';
                ladd.className = 'disco-ladd';
                ladd.draggable = false;
                ladd.style.setProperty('--glow-color', colors[i]);
                
                // Random position around the screen
                ladd.style.left = (Math.random() * (window.innerWidth - 400) + 200) + 'px';
                ladd.style.top = (Math.random() * (window.innerHeight - 300) + 100) + 'px';
                ladd.style.animationDelay = `${i * 0.25}s`;
                
                document.body.appendChild(ladd);
                discoLadds.push(ladd);
            }
            
            // Remove after frenzy ends
            setTimeout(() => {
                discoLadds.forEach(ladd => {
                    ladd.style.transition = 'opacity 1s';
                    ladd.style.opacity = '0';
                    setTimeout(() => ladd.remove(), 1000);
                });
                discoLadds = [];
            }, 77000);
        }

        function updateBuffTimer() {
            // Remove existing timer
            const existing = document.querySelector('.buff-timer');
            if (existing) existing.remove();
            
            const now = Date.now();
            
            // Check for active buffs
            if (now < gameState.frenzyExpires) {
                const remaining = Math.ceil((gameState.frenzyExpires - now) / 1000);
                const timer = document.createElement('div');
                timer.className = 'buff-timer frenzy';
                timer.textContent = `üî• FRENZY x7 - ${remaining}s`;
                document.body.appendChild(timer);
            } else if (now < gameState.goldenMultiplierExpires) {
                const remaining = Math.ceil((gameState.goldenMultiplierExpires - now) / 1000);
                const timer = document.createElement('div');
                timer.className = 'buff-timer click-frenzy';
                timer.textContent = `üëÜ CLICK FRENZY x777 - ${remaining}s`;
                document.body.appendChild(timer);
            }
        }

        function showNotification(title, message) {
            const notif = document.createElement('div');
            notif.className = 'notification';
            notif.innerHTML = `<div style="font-weight: 700; margin-bottom: 4px;">${title}</div><div style="color: #ccc;">${message}</div>`;
            document.body.appendChild(notif);
            
            setTimeout(() => {
                notif.style.animation = 'slideOut 0.3s ease-out';
                setTimeout(() => notif.remove(), 300);
            }, 3000);
        }

        function spawnStormCookie() {
            const storm = document.createElement('img');
            storm.src = 'https://github.com/westval/cookie-clicker-assets/blob/main/image-removebg-preview.png?raw=true';
            storm.style.position = 'fixed';
            storm.style.width = '48px';
            storm.style.height = '48px';
            storm.style.left = (Math.random() * (window.innerWidth - 640)) + 320 + 'px';
            storm.style.top = '-50px';
            storm.style.zIndex = '150';
            storm.style.pointerEvents = 'none';
            storm.style.filter = 'drop-shadow(0 0 8px rgba(255, 215, 0, 0.6))';
            storm.style.transition = 'all 1s ease-in';
            
            document.body.appendChild(storm);
            
            setTimeout(() => {
                storm.style.top = '50%';
                storm.style.transform = 'rotate(720deg) scale(0.5)';
                storm.style.opacity = '0';
            }, 50);
            
            setTimeout(() => storm.remove(), 1100);
        }

        const buildings = [
            { id: 'cursor', name: 'Ladd Shack', baseCost: 15, cps: 0.1, icon: 'üèöÔ∏è', description: 'A tiny hut where Nathan mutters productivity spells' },
            { id: 'grandma', name: "Nathan's Noise Factory", baseCost: 100, cps: 1, icon: 'üì¢', description: 'Produces resources by being loud for no reason' },
            { id: 'farm', name: "Ladd's Sock Museum", baseCost: 1100, cps: 8, icon: 'üß¶', description: 'Displays every sock he has ever lost. Generates confusion' },
            { id: 'mine', name: 'Nathan Clone Farm', baseCost: 12000, cps: 47, icon: 'üß¨', description: 'Grows fresh Nathans weekly. They scream when ripe' },
            { id: 'factory', name: "Ladd Laboratory of Questionable Science", baseCost: 130000, cps: 260, icon: 'üß™', description: 'Zero safety rules. Infinite output' },
            { id: 'bank', name: "Nathan's Burrito Observatory", baseCost: 1400000, cps: 1400, icon: 'üåØ', description: 'Studies burritos for "cosmic secrets"' },
            { id: 'temple', name: 'Ladd Tower of Mild Inconvenience', baseCost: 20000000, cps: 7800, icon: 'üóº', description: 'Annoys enemies until they give up' },
            { id: 'wizard', name: "Nathan's Gravity-Free Basement", baseCost: 330000000, cps: 44000, icon: 'üåÄ', description: 'Objects float. Productivity too, somehow' },
            { id: 'shipment', name: "Ladd's Interdimensional Drive-Thru", baseCost: 5100000000, cps: 260000, icon: 'üöó', description: "Serves customers who don't exist. Still profitable" },
            { id: 'alchemy', name: "Nathan's Spaghetti Reactor", baseCost: 75000000000, cps: 1600000, icon: 'üçù', description: 'Converts noodles into pure energy. Sometimes explodes' },
            { id: 'portal', name: "Ladd's Clone Recycling Center", baseCost: 1000000000000, cps: 10000000, icon: '‚ôªÔ∏è', description: 'Recycles defective Nathans into semi-defective ones' },
            { id: 'timemachine', name: "Nathan's Screaming Library", baseCost: 14000000000000, cps: 65000000, icon: 'üìö', description: 'Books yell the information at you' },
            { id: 'antimatter', name: "Ladd's Portal Garage", baseCost: 170000000000000, cps: 430000000, icon: 'üö™', description: 'Every car drives into another universe. Great reviews though' },
            { id: 'prism', name: "Nathan's Orb Hatchery", baseCost: 2100000000000000, cps: 2900000000, icon: 'üîÆ', description: 'Grows mysterious glowing orbs. None of them safe' },
            { id: 'chancemaker', name: "Ladd's Infinite Bathroom", baseCost: 26000000000000000, cps: 21000000000, icon: 'üöΩ', description: 'Has been flushing for 3 years straight. Infinite water somehow' }
        ];

        const upgrades = [
            { id: 'click1', name: "Nathan Ladd's Left Sock", cost: 100, icon: 'üß¶', effect: () => gameState.clickPower *= 2, description: 'Grants +1 luck but only if the right sock is missing. Clicking power x2' },
            { id: 'click2', name: "Super Ladd Slap", cost: 500, icon: 'üëã', effect: () => gameState.clickPower *= 2, description: 'Nathan slaps the air so hard production increases out of fear. Clicking power x2', requires: 'click1' },
            { id: 'click3', name: "Nathan's Microwave Brainwave", cost: 10000, icon: 'üìª', effect: () => gameState.clickPower *= 2, description: 'He sticks his head near the microwave for "ideas." Clicking power x2', requires: 'click2' },
            { id: 'click4', name: "Ladd's Quantum Toaster", cost: 100000, icon: 'üçû', effect: () => gameState.clickPower *= 2, description: 'Toasts bread and sometimes your save file. Clicking power x2', requires: 'click3' },
            { id: 'click5', name: "Nathan's Caffeinated Eyeball", cost: 1000000, icon: 'üëÅÔ∏è', effect: () => gameState.clickPower *= 2, description: 'It blinks twice per second. Terrifying and effective. Clicking power x2', requires: 'click4' },
            
            { id: 'cursor1', name: "Nathan's Invisible Chair", cost: 100, icon: 'üí∫', effect: () => multiplyBuilding('cursor', 2), description: 'He sits on nothing. Efficiency skyrockets. Ladd Shacks are twice as efficient', requires: { building: 'cursor', count: 1 } },
            { id: 'cursor2', name: "Ladd Slime Clone", cost: 500, icon: 'üü¢', effect: () => multiplyBuilding('cursor', 2), description: 'A goo version of Nathan helps‚Ä¶ kind of. Mostly oozes around. Ladd Shacks are twice as efficient', requires: { building: 'cursor', count: 5 } },
            { id: 'cursor3', name: "Nathan's Motivational Shriek", cost: 5000, icon: 'üò±', effect: () => multiplyBuilding('cursor', 2), description: 'He screams "BE BETTER" at the shacks daily. Ladd Shacks are twice as efficient', requires: { building: 'cursor', count: 10 } },
            
            { id: 'grandma1', name: "Nathan's Forbidden Chicken Nugget", cost: 1000, icon: 'üçó', effect: () => multiplyBuilding('grandma', 2), description: 'Increases speed but haunts you at night. Noise Factories are twice as efficient', requires: { building: 'grandma', count: 1 } },
            { id: 'grandma2', name: "Ladd's Pocket Dimension of Bees", cost: 5000, icon: 'üêù', effect: () => multiplyBuilding('grandma', 2), description: "You don't want to open it. Output somehow goes up. Noise Factories are twice as efficient", requires: { building: 'grandma', count: 5 } },
            { id: 'grandma3', name: "Nathan's Megaphone of Destiny", cost: 50000, icon: 'üì£', effect: () => multiplyBuilding('grandma', 2), description: "It's always on. There is no off switch. Noise Factories are twice as efficient", requires: { building: 'grandma', count: 10 } },
            
            { id: 'farm1', name: "Nathan's Extra Elbow", cost: 11000, icon: 'üí™', effect: () => multiplyBuilding('farm', 2), description: 'Gives him impossible clicking angles. Sock Museums are twice as efficient', requires: { building: 'farm', count: 1 } },
            { id: 'farm2', name: "Ladd's Screaming Shoes", cost: 55000, icon: 'üëü', effect: () => multiplyBuilding('farm', 2), description: "They scream every step. Terrible. Effective. Sock Museums are twice as efficient", requires: { building: 'farm', count: 5 } },
            { id: 'farm3', name: "Nathan's Sock Detector 3000", cost: 550000, icon: 'üîç', effect: () => multiplyBuilding('farm', 2), description: "Finds socks in other dimensions. Sock Museums are twice as efficient", requires: { building: 'farm', count: 10 } },
            
            { id: 'mine1', name: "Nathan's Toenail of Destiny", cost: 120000, icon: 'üíÖ', effect: () => multiplyBuilding('mine', 2), description: 'Generates 0.0001 more resources. Still worth it. Clone Farms are twice as efficient', requires: { building: 'mine', count: 1 } },
            { id: 'mine2', name: "Ladd's Growth Hormone (Expired)", cost: 600000, icon: 'üíâ', effect: () => multiplyBuilding('mine', 2), description: 'Makes clones grow faster. Side effects unknown. Clone Farms are twice as efficient', requires: { building: 'mine', count: 5 } },
            
            { id: 'factory1', name: "Ladd's Orb of Mild Confusion", cost: 1300000, icon: 'üîÆ', effect: () => multiplyBuilding('factory', 2), description: 'Everyone forgets what they\'re doing but works faster. Laboratories are twice as efficient', requires: { building: 'factory', count: 1 } },
            { id: 'factory2', name: "Nathan's Safety Goggles (Decorative)", cost: 6500000, icon: 'ü•Ω', effect: () => multiplyBuilding('factory', 2), description: 'They provide zero protection but boost morale. Laboratories are twice as efficient', requires: { building: 'factory', count: 5 } },
            
            { id: 'bank1', name: "Ladd's Burrito Telescope", cost: 14000000, icon: 'üî≠', effect: () => multiplyBuilding('bank', 2), description: 'Sees deeper into burrito space-time. Observatories are twice as efficient', requires: { building: 'bank', count: 1 } },
            { id: 'bank2', name: "Nathan's Hot Sauce of Enlightenment", cost: 70000000, icon: 'üå∂Ô∏è', effect: () => multiplyBuilding('bank', 2), description: 'Makes researchers see truth. And cry. Observatories are twice as efficient', requires: { building: 'bank', count: 5 } },
            
            { id: 'global1', name: "Nathan's Telepathic Burrito", cost: 50000, icon: 'üåØ', effect: () => gameState.globalMultiplier *= 1.5, description: 'Communicates only in vibes. Production improves anyway. Cookie production +50%' },
            { id: 'global2', name: "Ladd's Spaghetti Defense System", cost: 500000, icon: 'üçù', effect: () => gameState.globalMultiplier *= 1.5, description: 'Shoots noodles at intruders. Why? Don\'t ask. Cookie production +50%', requires: 'global1' },
            { id: 'global3', name: "Nathan's Haunted Fishstick", cost: 5000000, icon: 'üêü', effect: () => gameState.globalMultiplier *= 1.5, description: 'It watches you while you sleep. Cookie production +50%', requires: 'global2' },
            { id: 'global4', name: "Ladd's Cursed Spatula", cost: 50000000, icon: 'üç≥', effect: () => gameState.globalMultiplier *= 1.5, description: 'Flips pancakes and reality itself. Cookie production +50%', requires: 'global3' },
            { id: 'global5', name: "Nathan's Bluetooth Wisdom Tooth", cost: 500000000, icon: 'ü¶∑', effect: () => gameState.globalMultiplier *= 1.5, description: 'Transmits ancient knowledge wirelessly. Cookie production +50%', requires: 'global4' }
        ];

        const achievements = [
            // Cookie Milestones
            { id: 'cook1', name: 'Wake and bake', description: 'Bake 1 cookie', icon: 'üç™', check: () => gameState.totalCookies >= 1 },
            { id: 'cook2', name: 'Making some dough', description: 'Bake 100 cookies', icon: 'üç™', check: () => gameState.totalCookies >= 100 },
            { id: 'cook3', name: 'So baked right now', description: 'Bake 1,000 cookies', icon: 'üç™', check: () => gameState.totalCookies >= 1000 },
            { id: 'cook4', name: 'Fledgling bakery', description: 'Bake 10,000 cookies', icon: 'üç™', check: () => gameState.totalCookies >= 10000 },
            { id: 'cook5', name: 'Affluent', description: 'Bake 100,000 cookies', icon: 'üí∞', check: () => gameState.totalCookies >= 100000 },
            { id: 'cook6', name: 'World-famous', description: 'Bake 1 million cookies', icon: 'üåç', check: () => gameState.totalCookies >= 1000000 },
            { id: 'cook7', name: 'Cosmic baker', description: 'Bake 10 million cookies', icon: 'üåå', check: () => gameState.totalCookies >= 10000000 },
            { id: 'cook8', name: 'Galactic god', description: 'Bake 100 million cookies', icon: '‚≠ê', check: () => gameState.totalCookies >= 100000000 },
            { id: 'cook9', name: 'Cookieverse', description: 'Bake 1 billion cookies', icon: 'üå†', check: () => gameState.totalCookies >= 1000000000 },
            { id: 'cook10', name: 'You can stop now', description: 'Bake 10 billion cookies', icon: 'üî•', check: () => gameState.totalCookies >= 10000000000 },
            
            // Click Achievements
            { id: 'click1', name: 'Clicktastic', description: 'Click 100 times', icon: 'üëÜ', check: () => gameState.totalClicks >= 100 },
            { id: 'click2', name: 'Clickathlon', description: 'Click 1,000 times', icon: 'üëÜ', check: () => gameState.totalClicks >= 1000 },
            { id: 'click3', name: 'Clickorama', description: 'Click 10,000 times', icon: 'üëÜ', check: () => gameState.totalClicks >= 10000 },
            { id: 'click4', name: 'Clickasmic', description: 'Click 100,000 times', icon: 'üëÜ', check: () => gameState.totalClicks >= 100000 },
            { id: 'click5', name: 'Clickataclysm', description: 'Click 1 million times', icon: 'üëÜ', check: () => gameState.totalClicks >= 1000000 },
            
            // Hand-made cookies
            { id: 'hand1', name: 'Handmade', description: 'Make 1,000 cookies by clicking', icon: '‚úã', check: () => gameState.handMade >= 1000 },
            { id: 'hand2', name: 'Mass producer', description: 'Make 100,000 cookies by clicking', icon: '‚úã', check: () => gameState.handMade >= 100000 },
            { id: 'hand3', name: 'Cookie vortex', description: 'Make 10 million cookies by clicking', icon: '‚úã', check: () => gameState.handMade >= 10000000 },
            
            // Building Milestones - Ladd Shack
            { id: 'shack1', name: 'Shack attack', description: 'Own 1 Ladd Shack', icon: 'üèöÔ∏è', check: () => (gameState.buildings.cursor || 0) >= 1 },
            { id: 'shack10', name: 'Shack town', description: 'Own 10 Ladd Shacks', icon: 'üèöÔ∏è', check: () => (gameState.buildings.cursor || 0) >= 10 },
            { id: 'shack50', name: 'Shack city', description: 'Own 50 Ladd Shacks', icon: 'üèöÔ∏è', check: () => (gameState.buildings.cursor || 0) >= 50 },
            { id: 'shack100', name: 'Shack empire', description: 'Own 100 Ladd Shacks', icon: 'üèöÔ∏è', check: () => (gameState.buildings.cursor || 0) >= 100 },
            
            // Noise Factory
            { id: 'noise1', name: 'Mild racket', description: 'Own 1 Noise Factory', icon: 'üì¢', check: () => (gameState.buildings.grandma || 0) >= 1 },
            { id: 'noise10', name: 'Loud and proud', description: 'Own 10 Noise Factories', icon: 'üì¢', check: () => (gameState.buildings.grandma || 0) >= 10 },
            { id: 'noise50', name: 'Noise pollution', description: 'Own 50 Noise Factories', icon: 'üì¢', check: () => (gameState.buildings.grandma || 0) >= 50 },
            
            // Sock Museum
            { id: 'sock1', name: 'Sock it to me', description: 'Own 1 Sock Museum', icon: 'üß¶', check: () => (gameState.buildings.farm || 0) >= 1 },
            { id: 'sock10', name: 'Lost and found', description: 'Own 10 Sock Museums', icon: 'üß¶', check: () => (gameState.buildings.farm || 0) >= 10 },
            { id: 'sock50', name: 'Sockpocalypse', description: 'Own 50 Sock Museums', icon: 'üß¶', check: () => (gameState.buildings.farm || 0) >= 50 },
            
            // Total Buildings
            { id: 'build1', name: 'Base of operations', description: 'Own 10 buildings', icon: 'üè¢', check: () => getTotalBuildings() >= 10 },
            { id: 'build2', name: 'Experienced', description: 'Own 50 buildings', icon: 'üè¢', check: () => getTotalBuildings() >= 50 },
            { id: 'build3', name: 'Established', description: 'Own 100 buildings', icon: 'üè¢', check: () => getTotalBuildings() >= 100 },
            { id: 'build4', name: 'Well-established', description: 'Own 200 buildings', icon: 'üè¢', check: () => getTotalBuildings() >= 200 },
            { id: 'build5', name: 'Corporate', description: 'Own 300 buildings', icon: 'üè¢', check: () => getTotalBuildings() >= 300 },
            { id: 'build6', name: 'Megacorporate', description: 'Own 400 buildings', icon: 'üè¢', check: () => getTotalBuildings() >= 400 },
            
            // CPS Milestones
            { id: 'cps1', name: 'Casual baking', description: 'Produce 10 cookies per second', icon: '‚ö°', check: () => gameState.cookiesPerSecond >= 10 },
            { id: 'cps2', name: 'Hardcore baking', description: 'Produce 100 cookies per second', icon: '‚ö°', check: () => gameState.cookiesPerSecond >= 100 },
            { id: 'cps3', name: 'Steady stream', description: 'Produce 1,000 cookies per second', icon: '‚ö°', check: () => gameState.cookiesPerSecond >= 1000 },
            { id: 'cps4', name: 'Cookie automaton', description: 'Produce 10,000 cookies per second', icon: '‚ö°', check: () => gameState.cookiesPerSecond >= 10000 },
            { id: 'cps5', name: 'Cookie machine', description: 'Produce 100,000 cookies per second', icon: '‚ö°', check: () => gameState.cookiesPerSecond >= 100000 },
            { id: 'cps6', name: 'Cookie factory', description: 'Produce 1 million cookies per second', icon: '‚ö°', check: () => gameState.cookiesPerSecond >= 1000000 },
            { id: 'cps7', name: 'Cookie powerplant', description: 'Produce 10 million cookies per second', icon: '‚ö°', check: () => gameState.cookiesPerSecond >= 10000000 },
            
            // Upgrades
            { id: 'up1', name: 'Enhance', description: 'Purchase 1 upgrade', icon: '‚¨ÜÔ∏è', check: () => Object.keys(gameState.upgrades).length >= 1 },
            { id: 'up2', name: 'Augment', description: 'Purchase 5 upgrades', icon: '‚¨ÜÔ∏è', check: () => Object.keys(gameState.upgrades).length >= 5 },
            { id: 'up3', name: 'Improve', description: 'Purchase 10 upgrades', icon: '‚¨ÜÔ∏è', check: () => Object.keys(gameState.upgrades).length >= 10 },
            { id: 'up4', name: 'Modernize', description: 'Purchase 20 upgrades', icon: '‚¨ÜÔ∏è', check: () => Object.keys(gameState.upgrades).length >= 20 },
            
            // Prestige
            { id: 'prestige1', name: 'Rebirth', description: 'Ascend at least once', icon: '‚ú®', check: () => gameState.prestigeLevel >= 1 },
            { id: 'prestige2', name: 'Resurrection', description: 'Ascend 5 times', icon: '‚ú®', check: () => gameState.prestigeLevel >= 5 },
            { id: 'prestige3', name: 'Reincarnation', description: 'Ascend 10 times', icon: '‚ú®', check: () => gameState.prestigeLevel >= 10 },
            { id: 'prestige4', name: 'Eternal', description: 'Ascend 25 times', icon: '‚ú®', check: () => gameState.prestigeLevel >= 25 },
            
            // Special
            { id: 'speed1', name: 'Speedrunner', description: 'Bake 1 million cookies in 30 minutes', icon: 'üèÉ', check: () => false }, // Would need timer
            { id: 'lucky1', name: 'Lucky day', description: 'Click a golden Ladd', icon: 'üçÄ', check: () => gameState.goldenClicks >= 1 },
            { id: 'lucky2', name: 'Extremely lucky', description: 'Click 10 golden Ladds', icon: 'üçÄ', check: () => gameState.goldenClicks >= 10 },
            { id: 'lucky3', name: 'Fortuitous', description: 'Click 100 golden Ladds', icon: 'üçÄ', check: () => gameState.goldenClicks >= 100 }
        ];

        let tooltip = null;
        let audioContext = null;

        // More satisfying sound generator with multiple oscillators
        function playSound(frequencies, duration, type = 'sine', volume = 0.15) {
            if (!audioContext) {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
            }
            
            frequencies.forEach((freq, index) => {
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.value = freq;
                oscillator.type = type;
                
                const delay = index * 0.02;
                gainNode.gain.setValueAtTime(volume, audioContext.currentTime + delay);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + delay + duration);
                
                oscillator.start(audioContext.currentTime + delay);
                oscillator.stop(audioContext.currentTime + delay + duration);
            });
        }

        function playClickSound() {
            // Rich, satisfying click with harmonics
            playSound([800, 1200, 1600], 0.08, 'sine', 0.12);
        }

        function playBuySound() {
            // Satisfying purchase sound - ascending chime
            playSound([523.25, 659.25, 783.99], 0.15, 'triangle', 0.18);
        }

        function playGoldenSound() {
            // Magical golden cookie sound
            playSound([1046.50, 1318.51, 1567.98, 2093.00], 0.25, 'sine', 0.2);
        }

        function playButtonSound() {
            // Soft button click
            playSound([600, 800], 0.06, 'square', 0.08);
        }

        function renderCursorOrbiters() {
            const container = document.getElementById('cursorOrbiter');
            const cursorCount = gameState.buildings.cursor || 0;
            
            // Clear existing cursors
            container.innerHTML = '';
            
            // Add cursor orbiters based on count (max 10 visible)
            const displayCount = Math.min(cursorCount, 10);
            for (let i = 0; i < displayCount; i++) {
                const cursor = document.createElement('div');
                cursor.className = 'cursor-orbiter';
                cursor.style.animationDelay = `-${(i / displayCount) * 3}s`;
                cursor.style.animationDuration = `${3 + (i * 0.1)}s`;
                
                const img = document.createElement('img');
                img.src = 'https://github.com/westval/cookie-clicker-assets/blob/main/image-removebg-preview.png?raw=true';
                img.draggable = false;
                cursor.appendChild(img);
                
                container.appendChild(cursor);
            }
        }

        // Admin Panel Functions
        function checkAdminPassword(password) {
            if (password.toLowerCase() === 'kirk') {
                gameState.adminUnlocked = true;
                document.getElementById('adminPanel').style.display = 'block';
                document.getElementById('adminPassword').value = '';
                document.getElementById('adminPassword').placeholder = '‚úÖ Admin Unlocked!';
                showNotification('üîß Admin Access', 'Admin panel unlocked!');
            } else {
                document.getElementById('adminPassword').value = '';
                showNotification('‚ùå Access Denied', 'Incorrect code');
            }
        }

        function adminAddCookies() {
            if (!gameState.adminUnlocked) return;
            const amount = parseFloat(document.getElementById('adminCookies').value) || 0;
            gameState.cookies += amount;
            gameState.totalCookies += amount;
            updateDisplay();
            showNotification('üç™ Admin', `Added ${formatNumber(amount)} cookies`);
        }

        function adminTriggerFrenzy() {
            if (!gameState.adminUnlocked) return;
            gameState.frenzyMultiplier = 7;
            gameState.frenzyExpires = Date.now() + 77000;
            showNotification('üî• Admin Frenzy', 'Production x7 for 77 seconds!');
            playGoldenSound();
            startDiscoParty();
        }

        function adminTriggerClickFrenzy() {
            if (!gameState.adminUnlocked) return;
            gameState.goldenMultiplier = 777;
            gameState.goldenMultiplierExpires = Date.now() + 13000;
            showNotification('üëÜ Admin Click Frenzy', 'Clicking power x777 for 13 seconds!');
            playGoldenSound();
        }

        function renameBakery(newName) {
            if (newName && newName.trim().length > 0) {
                gameState.bakeryName = newName.trim();
                document.getElementById('bakeryName').textContent = gameState.bakeryName;
                saveGame();
            }
        }

        function initGame() {
            buildings.forEach(b => {
                if (!gameState.buildings[b.id]) gameState.buildings[b.id] = 0;
            });
            
            renderBuildings();
            renderUpgrades();
            renderAchievements();
            renderCursorOrbiters();
            updateDisplay();
            
            setInterval(() => {
                calculateCPS(); // Recalculate each time in case frenzy expires
                const gain = gameState.cookiesPerSecond / 30;
                gameState.cookies += gain;
                gameState.totalCookies += gain;
                updateDisplay();
                updateStats();
                updateBigCookieGlow();
                updateBuffTimer();
                checkAchievements();
            }, 33);

            setInterval(saveGame, 30000);
            setInterval(spawnGoldenCookie, Math.random() * 60000 + 60000);

            loadGame();
        }

        function clickCookie(event) {
            const prestigeBonus = gameState.prestigeLevel * 0.01;
            const goldenBonus = Date.now() < gameState.goldenMultiplierExpires ? gameState.goldenMultiplier : 1;
            const clickValue = gameState.clickPower * (1 + prestigeBonus) * goldenBonus;
            
            gameState.cookies += clickValue;
            gameState.totalCookies += clickValue;
            gameState.totalClicks++;
            gameState.handMade += clickValue;

            // Play click sound
            playClickSound();

            // Add bounce animation to cookie
            const bigCookie = document.getElementById('bigCookie');
            bigCookie.classList.remove('cookie-bounce');
            void bigCookie.offsetWidth; // Force reflow
            bigCookie.classList.add('cookie-bounce');

            // Add ripple effect
            const ripple = document.createElement('div');
            ripple.className = 'ripple';
            ripple.style.left = (event.clientX - 150) + 'px';
            ripple.style.top = (event.clientY - 150) + 'px';
            document.body.appendChild(ripple);
            setTimeout(() => ripple.remove(), 600);

            // Spawn MORE particles (10 during click frenzy, 7 normally)
            const particleCount = goldenBonus > 1 ? 12 : 7;
            for (let i = 0; i < particleCount; i++) {
                setTimeout(() => {
                    const isBig = Math.random() > 0.7;
                    spawnParticle(event.clientX, event.clientY, isBig);
                }, i * 15);
            }

            // Screen shake on big clicks
            if (clickValue > gameState.cookiesPerSecond * 10) {
                document.getElementById('middlePanel').classList.add('shake');
                setTimeout(() => {
                    document.getElementById('middlePanel').classList.remove('shake');
                }, 300);
            }

            // Floating text
            showFloatingText(event.clientX, event.clientY, `+${formatNumber(clickValue)}`);

            updateDisplay();
            checkAchievements();
        }

        function spawnParticle(x, y, isBig = false) {
            const particle = document.createElement('div');
            particle.className = isBig ? 'particle particle-big' : 'particle';
            
            const img = document.createElement('img');
            img.src = 'https://github.com/westval/cookie-clicker-assets/blob/main/image-removebg-preview.png?raw=true';
            img.draggable = false;
            particle.appendChild(img);
            
            const angle = Math.random() * Math.PI * 2;
            const distance = isBig ? 80 + Math.random() * 120 : 50 + Math.random() * 100;
            const tx = Math.cos(angle) * distance;
            const ty = Math.sin(angle) * distance - (isBig ? 80 : 50);
            const rotation = Math.random() * 720 - 360;
            
            particle.style.setProperty('--tx', tx + 'px');
            particle.style.setProperty('--ty', ty + 'px');
            particle.style.setProperty('--rotation', rotation + 'deg');
            
            particle.style.left = x + 'px';
            particle.style.top = y + 'px';
            
            document.body.appendChild(particle);
            
            setTimeout(() => particle.remove(), isBig ? 1200 : 1000);
        }

        function showFloatingText(x, y, text) {
            const floater = document.createElement('div');
            floater.className = 'floatingText';
            floater.textContent = text;
            floater.style.left = x + 'px';
            floater.style.top = y + 'px';
            
            document.body.appendChild(floater);
            
            setTimeout(() => floater.remove(), 1000);
        }

        function showFloatingText(x, y, text) {
            const floater = document.createElement('div');
            floater.className = 'floatingText';
            floater.textContent = text;
            floater.style.left = x + 'px';
            floater.style.top = y + 'px';
            document.body.appendChild(floater);
            
            setTimeout(() => floater.remove(), 1000);
        }

        function calculateCPS() {
            let cps = 0;
            buildings.forEach(building => {
                const count = gameState.buildings[building.id] || 0;
                const multiplier = gameState.buildingMultipliers[building.id] || 1;
                cps += building.cps * count * multiplier;
            });
            
            const prestigeBonus = gameState.prestigeLevel * 0.01;
            const frenzyBonus = Date.now() < gameState.frenzyExpires ? gameState.frenzyMultiplier : 1;
            gameState.cookiesPerSecond = cps * gameState.globalMultiplier * (1 + prestigeBonus) * frenzyBonus;
        }

        function setBuyAmount(amount) {
            gameState.buyAmount = amount;
            playButtonSound();
            
            // Update button states
            document.querySelectorAll('.buy-amount-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            renderBuildings();
        }

        function buyBuilding(buildingId) {
            const building = buildings.find(b => b.id === buildingId);
            const currentCount = gameState.buildings[buildingId] || 0;
            
            let amountToBuy = gameState.buyAmount;
            
            // Calculate max affordable if buy amount is 'max'
            if (gameState.buyAmount === 'max') {
                amountToBuy = 0;
                let totalCost = 0;
                while (true) {
                    const cost = Math.floor(building.baseCost * Math.pow(1.15, currentCount + amountToBuy));
                    if (totalCost + cost > gameState.cookies) break;
                    totalCost += cost;
                    amountToBuy++;
                    if (amountToBuy >= 1000) break; // Safety limit
                }
            }
            
            // Calculate total cost for bulk purchase
            let totalCost = 0;
            for (let i = 0; i < amountToBuy; i++) {
                totalCost += Math.floor(building.baseCost * Math.pow(1.15, currentCount + i));
            }
            
            if (gameState.cookies >= totalCost && amountToBuy > 0) {
                gameState.cookies -= totalCost;
                gameState.buildings[buildingId] = currentCount + amountToBuy;
                
                // Play buy sound
                playBuySound();
                
                // Update cursor orbiters if cursor was bought
                if (buildingId === 'cursor') {
                    renderCursorOrbiters();
                }
                
                calculateCPS();
                renderBuildings();
                renderUpgrades();
                updateDisplay();
                checkAchievements();
            }
        }

        function buyUpgrade(upgradeId) {
            const upgrade = upgrades.find(u => u.id === upgradeId);
            
            if (gameState.upgrades[upgradeId]) return;
            if (gameState.cookies < upgrade.cost) return;
            
            gameState.cookies -= upgrade.cost;
            gameState.upgrades[upgradeId] = true;
            upgrade.effect();
            
            // Play buy sound
            playBuySound();
            
            calculateCPS();
            renderUpgrades();
            updateDisplay();
        }

        function multiplyBuilding(buildingId, multiplier) {
            gameState.buildingMultipliers[buildingId] = (gameState.buildingMultipliers[buildingId] || 1) * multiplier;
        }

        function isUpgradeAvailable(upgrade) {
            if (gameState.upgrades[upgrade.id]) return false;
            
            if (upgrade.requires) {
                if (typeof upgrade.requires === 'string') {
                    return gameState.upgrades[upgrade.requires];
                }
                if (upgrade.requires.building) {
                    return (gameState.buildings[upgrade.requires.building] || 0) >= upgrade.requires.count;
                }
            }
            return true;
        }

        function renderBuildings() {
            const container = document.getElementById('buildingsContainer');
            container.innerHTML = '';
            
            buildings.forEach(building => {
                const count = gameState.buildings[building.id] || 0;
                const multiplier = gameState.buildingMultipliers[building.id] || 1;
                const totalCps = building.cps * count * multiplier;
                
                // Calculate cost based on buy amount
                let displayCost = 0;
                let amountToBuy = gameState.buyAmount;
                
                if (gameState.buyAmount === 'max') {
                    amountToBuy = 0;
                    let totalCost = 0;
                    while (true) {
                        const cost = Math.floor(building.baseCost * Math.pow(1.15, count + amountToBuy));
                        if (totalCost + cost > gameState.cookies) break;
                        totalCost += cost;
                        amountToBuy++;
                        if (amountToBuy >= 1000) break;
                    }
                    displayCost = 0;
                    for (let i = 0; i < amountToBuy; i++) {
                        displayCost += Math.floor(building.baseCost * Math.pow(1.15, count + i));
                    }
                } else {
                    for (let i = 0; i < amountToBuy; i++) {
                        displayCost += Math.floor(building.baseCost * Math.pow(1.15, count + i));
                    }
                }
                
                const canAfford = gameState.cookies >= displayCost && displayCost > 0;
                
                const div = document.createElement('div');
                div.className = `product ${canAfford ? 'enabled' : 'locked'}`;
                
                // Use mousedown for instant response
                div.addEventListener('mousedown', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    const currentCost = displayCost;
                    if (gameState.cookies >= currentCost && currentCost > 0) {
                        // Visual feedback
                        this.classList.add('pressed');
                        setTimeout(() => this.classList.remove('pressed'), 150);
                        
                        // Buy the building
                        buyBuilding(building.id);
                    }
                });
                
                // Also handle touch
                div.addEventListener('touchstart', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    if (gameState.cookies >= displayCost && displayCost > 0) {
                        this.classList.add('pressed');
                        setTimeout(() => this.classList.remove('pressed'), 150);
                        buyBuilding(building.id);
                    }
                });
                
                div.innerHTML = `
                    <div class="product-inner">
                        <div class="product-icon" style="font-size: 32px; display: flex; align-items: center; justify-content: center;">${building.icon}</div>
                        <div class="product-info">
                            <div class="product-name">${building.name}</div>
                            <div class="product-price">${formatNumber(displayCost)}</div>
                        </div>
                        <div class="product-count">${count}</div>
                    </div>
                `;
                
                div.onmouseenter = (e) => showTooltip(e, building.name, building.description, displayCost, totalCps);
                div.onmouseleave = hideTooltip;
                div.onmousemove = (e) => {
                    if (tooltip) {
                        tooltip.style.left = e.pageX + 20 + 'px';
                        tooltip.style.top = e.pageY + 'px';
                    }
                };
                
                container.appendChild(div);
            });
        }

        function renderUpgrades() {
            const container = document.getElementById('upgradesContainer');
            container.innerHTML = '';
            
            upgrades.forEach(upgrade => {
                if (!isUpgradeAvailable(upgrade)) return;
                
                const canAfford = gameState.cookies >= upgrade.cost;
                
                const div = document.createElement('div');
                div.className = `upgrade ${canAfford ? 'enabled' : 'locked'}`;
                
                // Use mousedown for instant response
                div.addEventListener('mousedown', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    if (gameState.cookies >= upgrade.cost && !gameState.upgrades[upgrade.id]) {
                        // Visual feedback
                        this.classList.add('pressed');
                        setTimeout(() => this.classList.remove('pressed'), 150);
                        
                        // Buy the upgrade
                        buyUpgrade(upgrade.id);
                    }
                });
                
                // Also handle touch
                div.addEventListener('touchstart', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    if (gameState.cookies >= upgrade.cost && !gameState.upgrades[upgrade.id]) {
                        this.classList.add('pressed');
                        setTimeout(() => this.classList.remove('pressed'), 150);
                        buyUpgrade(upgrade.id);
                    }
                });
                
                const inner = document.createElement('div');
                inner.className = 'upgrade-inner';
                inner.textContent = upgrade.icon;
                
                div.appendChild(inner);
                
                div.onmouseenter = (e) => showTooltip(e, upgrade.name, upgrade.description, upgrade.cost);
                div.onmouseleave = hideTooltip;
                div.onmousemove = (e) => {
                    if (tooltip) {
                        tooltip.style.left = e.pageX + 20 + 'px';
                        tooltip.style.top = e.pageY + 'px';
                    }
                };
                
                container.appendChild(div);
            });
        }

        function renderAchievements() {
            const container = document.getElementById('achievementsContainer');
            container.innerHTML = '';
            
            achievements.forEach(achievement => {
                const unlocked = gameState.achievements[achievement.id];
                
                const div = document.createElement('div');
                div.className = `achievement ${unlocked ? 'unlocked' : ''}`;
                
                div.innerHTML = `
                    <div class="achievement-icon" style="font-size: 32px; display: flex; align-items: center; justify-content: center;">${achievement.icon}</div>
                    <div class="achievement-info">
                        <div class="achievement-name">${achievement.name}</div>
                        <div class="achievement-desc">${achievement.description}</div>
                    </div>
                `;
                
                container.appendChild(div);
            });
        }

        function showTooltip(e, name, desc, cost, production) {
            hideTooltip();
            
            tooltip = document.createElement('div');
            tooltip.className = 'tooltip';
            
            let html = `<div class="tooltip-title">${name}</div>`;
            html += `<div class="tooltip-desc">${desc}</div>`;
            if (production) html += `<div>Producing: ${formatNumber(production)}/sec</div>`;
            html += `<div class="tooltip-price">Cost: ${formatNumber(cost)}</div>`;
            
            tooltip.innerHTML = html;
            document.body.appendChild(tooltip);
            
            // Position tooltip and keep it within screen bounds
            let x = e.pageX + 20;
            let y = e.pageY;
            
            // Check right edge
            if (x + tooltip.offsetWidth > window.innerWidth) {
                x = e.pageX - tooltip.offsetWidth - 20;
            }
            
            // Check bottom edge
            if (y + tooltip.offsetHeight > window.innerHeight) {
                y = window.innerHeight - tooltip.offsetHeight - 10;
            }
            
            // Check top edge
            if (y < 10) {
                y = 10;
            }
            
            tooltip.style.left = x + 'px';
            tooltip.style.top = y + 'px';
        }

        function hideTooltip() {
            if (tooltip) {
                tooltip.remove();
                tooltip = null;
            }
        }

        function checkAchievements() {
            let newUnlocks = false;
            achievements.forEach(achievement => {
                if (!gameState.achievements[achievement.id] && achievement.check()) {
                    gameState.achievements[achievement.id] = true;
                    newUnlocks = true;
                }
            });
            
            if (newUnlocks) {
                renderAchievements();
                updateMilk();
            }
        }

        function updateMilk() {
            const total = achievements.length;
            const unlocked = Object.keys(gameState.achievements).length;
            const percent = (unlocked / total) * 100;
            document.getElementById('milkLevel').style.height = percent + '%';
        }

        function getTotalBuildings() {
            return Object.values(gameState.buildings).reduce((a, b) => a + b, 0);
        }

        function spawnGoldenCookie() {
            const golden = document.createElement('img');
            golden.className = 'golden-cookie';
            golden.src = 'https://github.com/westval/cookie-clicker-assets/blob/main/image-removebg-preview.png?raw=true';
            golden.draggable = false;
            golden.style.left = (Math.random() * (window.innerWidth - 320 - 320 - 100)) + 320 + 'px';
            golden.style.top = Math.random() * (window.innerHeight - 100) + 'px';
            golden.style.filter = 'drop-shadow(0 0 20px gold) brightness(1.5) saturate(2)';
            
            golden.onclick = () => {
                gameState.goldenClicks++;
                
                // Choose random golden effect based on weights
                const totalWeight = goldenEffects.reduce((sum, e) => sum + e.weight, 0);
                let random = Math.random() * totalWeight;
                
                for (const effect of goldenEffects) {
                    random -= effect.weight;
                    if (random <= 0) {
                        effect.effect();
                        break;
                    }
                }
                
                golden.remove();
                updateDisplay();
                checkAchievements();
            };
            
            document.body.appendChild(golden);
            setTimeout(() => golden.remove(), 13000);
        }

        // Update big cookie glow based on active effects (moved to buff timer display)
        function updateBigCookieGlow() {
            // Visual effects now handled by buff timer display
        }

        function doPrestige() {
            if (gameState.totalCookies < 1000000000) {
                alert('You need at least 1 billion total cookies to ascend!');
                return;
            }
            
            const heavenly = Math.floor(Math.sqrt(gameState.totalCookies / 1000000000));
            
            if (!confirm(`Ascend and reset everything to gain ${heavenly} Heavenly Chips (+${heavenly}% production)?`)) {
                return;
            }
            
            gameState.heavenlyChips += heavenly;
            gameState.prestigeLevel += heavenly;
            
            const prestige = gameState.prestigeLevel;
            const chips = gameState.heavenlyChips;
            
            gameState = {
                cookies: 0,
                totalCookies: 0,
                cookiesPerSecond: 0,
                clickPower: 1,
                totalClicks: 0,
                handMade: 0,
                buildings: {},
                upgrades: {},
                achievements: {},
                prestigeLevel: prestige,
                heavenlyChips: chips,
                buildingMultipliers: {},
                globalMultiplier: 1
            };
            
            initGame();
        }

        let lastRenderTime = 0;
        
        function updateStats() {
            document.getElementById('stats-cookies').textContent = formatNumber(gameState.cookies.toFixed(1));
            document.getElementById('stats-this-run').textContent = formatNumber(Math.floor(gameState.totalCookies));
            document.getElementById('stats-all-time').textContent = formatNumber(Math.floor(gameState.totalCookies));
            document.getElementById('stats-buildings').textContent = getTotalBuildings();
            document.getElementById('stats-cps').textContent = formatNumber(gameState.cookiesPerSecond.toFixed(1));
            document.getElementById('stats-raw-cps').textContent = formatNumber(gameState.cookiesPerSecond.toFixed(1));
            document.getElementById('stats-per-click').textContent = formatNumber(gameState.clickPower);
            document.getElementById('stats-clicks').textContent = formatNumber(gameState.totalClicks);
            document.getElementById('stats-handmade').textContent = formatNumber(Math.floor(gameState.handMade));
            document.getElementById('stats-golden').textContent = gameState.goldenClicks;
            
            const unlockedAchievements = Object.keys(gameState.achievements).length;
            document.getElementById('stats-achievements').textContent = unlockedAchievements;
            document.getElementById('stats-achievements-total').textContent = achievements.length;
            
            const unlockedUpgrades = Object.keys(gameState.upgrades).length;
            document.getElementById('stats-upgrades').textContent = unlockedUpgrades;
            document.getElementById('stats-upgrades-total').textContent = upgrades.length;
            
            // Render achievement icons in stats
            const container = document.getElementById('statsAchievementsContainer');
            container.innerHTML = '';
            achievements.forEach(achievement => {
                const unlocked = gameState.achievements[achievement.id];
                const div = document.createElement('div');
                div.style.cssText = `
                    width: 48px; height: 48px; background: ${unlocked ? 'linear-gradient(to bottom, #4a4a3a 0%, #3a3a2a 100%)' : 'linear-gradient(to bottom, #2a2a2a 0%, #222222 100%)'};
                    border: 2px solid ${unlocked ? '#5a5a4a' : '#3a3a3a'}; border-radius: 4px;
                    display: flex; align-items: center; justify-content: center;
                    font-size: 28px; opacity: ${unlocked ? '1' : '0.3'};
                    filter: ${unlocked ? 'none' : 'grayscale(100%)'};
                `;
                div.textContent = achievement.icon;
                div.title = achievement.name + ': ' + achievement.description;
                container.appendChild(div);
            });
        }

        function updateDisplay() {
            // Show with 1 decimal place
            document.getElementById('cookieCount').textContent = formatNumber(gameState.cookies.toFixed(1));
            document.getElementById('cookiePs').textContent = 'per second: ' + formatNumber(gameState.cookiesPerSecond.toFixed(1));
            document.getElementById('totalClicks').textContent = formatNumber(gameState.totalClicks);
            document.getElementById('handMade').textContent = formatNumber(Math.floor(gameState.handMade));
            document.getElementById('totalEarned').textContent = formatNumber(Math.floor(gameState.totalCookies));
            document.getElementById('prestigeLevel').textContent = gameState.prestigeLevel;
            document.getElementById('prestigeBonus').textContent = gameState.prestigeLevel;
            document.getElementById('heavenlyChips').textContent = gameState.heavenlyChips;
            
            const heavenly = Math.floor(Math.sqrt(gameState.totalCookies / 1000000000));
            document.getElementById('gainOnAscension').textContent = heavenly;
            document.getElementById('prestigeBtn').disabled = gameState.totalCookies < 1000000000;
            
            // Only re-render buildings/upgrades once per second to improve performance
            const now = Date.now();
            if (now - lastRenderTime > 100) {
                renderBuildings();
                renderUpgrades();
                lastRenderTime = now;
            }
        }

        function formatNumber(num) {
            if (num < 1000) return Math.floor(num).toString();
            if (num < 1000000) return (num / 1000).toFixed(1) + ' thousand';
            if (num < 1000000000) return (num / 1000000).toFixed(1) + ' million';
            if (num < 1000000000000) return (num / 1000000000).toFixed(1) + ' billion';
            if (num < 1000000000000000) return (num / 1000000000000).toFixed(1) + ' trillion';
            if (num < 1000000000000000000) return (num / 1000000000000000).toFixed(1) + ' quadrillion';
            return (num / 1000000000000000000).toFixed(1) + ' quintillion';
        }

        function switchTab(tabName) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
        }

        function saveGame() {
            localStorage.setItem('cookieClickerSave', JSON.stringify(gameState));
        }

        function loadGame() {
            const saved = localStorage.getItem('cookieClickerSave');
            if (saved) {
                try {
                    const loaded = JSON.parse(saved);
                    Object.assign(gameState, loaded);
                    calculateCPS();
                    renderBuildings();
                    renderUpgrades();
                    renderAchievements();
                    renderCursorOrbiters();
                    updateDisplay();
                    updateMilk();
                    
                    // Restore bakery name
                    document.getElementById('bakeryName').textContent = gameState.bakeryName || "Ladd's Bakery";
                    document.getElementById('bakeryNameInput').value = gameState.bakeryName || "Ladd's Bakery";
                    
                    // Restore admin panel if unlocked
                    if (gameState.adminUnlocked) {
                        document.getElementById('adminPanel').style.display = 'block';
                        document.getElementById('adminPassword').placeholder = '‚úÖ Admin Unlocked!';
                    }
                } catch (e) {
                    console.error('Failed to load save:', e);
                }
            }
        }

        function exportSave() {
            const saveData = btoa(JSON.stringify(gameState));
            prompt('Copy this save code:', saveData);
        }

        function importSave() {
            const saveData = prompt('Paste your save code:');
            if (saveData) {
                try {
                    const loaded = JSON.parse(atob(saveData));
                    Object.assign(gameState, loaded);
                    initGame();
                    alert('Save loaded successfully!');
                } catch (e) {
                    alert('Invalid save code!');
                }
            }
        }

        function resetGame() {
            if (confirm('Are you sure you want to wipe your save? This cannot be undone!')) {
                localStorage.removeItem('cookieClickerSave');
                location.reload();
            }
        }

        document.getElementById('bigCookie').addEventListener('click', clickCookie);
        
        initGame();
    </script>
</body>
</html>